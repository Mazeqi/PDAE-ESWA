{
    "trainer_para":{
        "seed":88,
        "data_path":"/home/tanpengjie1/Mazeqi/dataset/mvtec/",
        "dataset_name":"mvtec",
        "train_class_mode":"one_class_para",
        "class_list":["bottle", "cable", "capsule", "hazelnut", "metal_nut",
                        "pill", "screw", "toothbrush", "transistor","zipper",
                    "carpet", "grid","leather", "tile",  "wood"],
        "layer_agg":{
            "mode":false,
            "layer_ch":768
        },
        "cait":{
            "backbone_name":"cait",
            "mode":false,
            "layers":["blocks.15"]
        },
        "class_name":"capsule",
        "score_method":"patch_dis",
        "patch_reduce_dim":512,
        "patch_score_lr":0.65,
        "patch_score_size":4,
        "model_test_load_only_values":false,
        "save_test_image":false,
        "train_mode":"ov_train",
        "device":"cuda:0",
        "ori_backbone_name":"densenet201",
        "aug_backbone_name":"densenet201",
        "net_name":"mv_CAE_Tconv_Simple",
        "net_ori_name":"mv_CAE_Tconv_Simple_Skip",
        "outdir_final_index_name":"den12_cait15_l96_s384_layagg768",
        "n_epochs":200,
        "layer_size":96,
        "image_size":384,
        "optimizer_name":"adam",
        "scheduler_name":"plateau",
        "loss_name":"mse",
        "contrastive_loss":"contras",
        "loss_contrastive_beta":1e-5,
        "aug_model_out_layers":[3],
        "ori_model_out_layers":[3],
        "ori_ly_model_out_layers":[0, 1, 2, 3],
        "network_layer":{
            "resnet18":{
                "default":{
                    "input_size_layer":"layer1",
                    "layers":["layer1", "layer2", "layer3"]
                }
            },

            "densenet201":{
                "default":{
                    "input_size_layer":"features.denseblock2",
                    "layers":["features.denseblock2", "features.denseblock3"]
                }
            },
            "wideresnet50":{
                "default":{
                    "input_size_layer":"layer1",
                    "layers":["layer1", "layer2"]
                }
            },
            "resnet101":{
                "default":{
                    "input_size_layer":"layer1",
                    "layers":["layer1", "layer2"]
                }
            },
            "resnet50":{
                "default":{
                    "input_size_layer":"layer2",
                    "layers":["layer2", "layer3"]
                }
            },
            "resnet50_de":{
                "default":{
                    "input_size_layer":"layer2",
                    "layers":["layer2", "layer3"]
                },

                "mvtec_loco_default":{
                    "breakfast_box":  {
                        "input_size_layer":"layer1",
                        "layers":["layer1", "layer2"]
                    }, 
                    "juice_bottle":  {
                        "input_size_layer":"layer1",
                        "layers":["layer1", "layer2"]
                    }, 
                    "pushpins":  {
                        "input_size_layer":"layer1",
                        "layers":["layer1", "layer2"]
                    }, 
                    "screw_bag":  {
                        "input_size_layer":"layer1",
                        "layers":["layer1", "layer2"]
                    }, 
                    "splicing_connectors":  {
                        "input_size_layer":"layer1",
                        "layers":["layer1", "layer2"]
                    }
                },

                "btad":{
                    "class1":  {
                        "input_size_layer":"layer1",
                        "layers":["layer1", "layer2"]
                    },
                    "class2":  {
                        "input_size_layer":"layer1",
                        "layers":["layer1", "layer2"]
                    },
                    "class3":  {
                        "input_size_layer":"layer1",
                        "layers":["layer1", "layer2"]
                    }
                   
                },
                "mvtec":{
                    "bottle":  {
                        "input_size_layer":"layer1",
                        "layers":["layer1", "layer2"]
                    },
                    "cable":   {
                        "input_size_layer":"layer2",
                        "layers":["layer2", "layer3"]
                    },
                    "capsule": {
                        "input_size_layer":"layer1",
                        "layers":["layer1", "layer2"]
                    },
                    "carpet":  {
                        "input_size_layer":"layer2",
                        "layers":["layer2", "layer3"]
                    },
                    "grid":   {
                        "input_size_layer":"layer2",
                        "layers":["layer1", "layer2"]
                    } ,
                    "hazelnut":{
                        "input_size_layer":"layer1",
                        "layers":["layer1", "layer2"]
                    },
                    "leather":  {
                        "input_size_layer":"layer1",
                        "layers":["layer1", "layer2"]
                    },
                    "metal_nut":{
                        "input_size_layer":"layer2",
                        "layers":["layer2", "layer3"]
                    },
                    "pill": {
                        "input_size_layer":"layer1",
                        "layers":["layer1", "layer2"]
                    },
                    "screw":    {
                        "input_size_layer":"layer1",
                        "layers":["layer1", "layer2"]
                    },
                    "tile":   {
                        "input_size_layer":"layer2",
                        "layers":["layer1", "layer2"]
                    },
                    "toothbrush":{
                        "input_size_layer":"layer1",
                        "layers":["layer1", "layer2"]
                    },
                    "transistor":{
                        "input_size_layer":"layer2",
                        "layers":["layer2", "layer3"]
                    },
                    "wood":{
                        "input_size_layer":"layer1",
                        "layers": ["layer1", "layer2"]
                    }     ,
                    "zipper":   {
                        "input_size_layer":"layer1",
                        "layers": ["layer1", "layer2"]
                    }
                }
            }
            
        }
    },
    

    "optim_para":{
        "ori_view":{
            "sgd":{
                "lr":0.1,
                "momentum":0.9,
                "weight_decay":1e-6
            },
            "adam":{
                "lr":1e-3,
                "weight_decay":1e-5
            },
            "adamw":{
                "lr":4e-4,  
                "weight_decay":0.0001         
            }
        },

        "aug_view":{
            "sgd":{
                "lr":0.1,
                "momentum":0.9,
                "weight_decay":1e-6
            },
            "adam":{
                "lr":1e-3,
                "weight_decay":1e-5
            },
            "adamw":{
                "lr":4e-4,  
                "weight_decay":0.0001         
            }
        }
        
    },
    "dataset_para":{
        "cutpaste":{
            "mode":true,
            "cutpaste_noise":{
                "mvtec":[0.8, 0.6, 0.5, 0.5],
                "btad":[0.8, 0.6, 0.5, 0.5],
                "mvtec_loco":[0.8, 0.6, 0.5, 0.5]
            }
            
        }
       
    },
    "dataloader_para":{
        "batch_size":8,
        "num_workers":4
    },
    "network_init_para":{
        "init_weight":{
            "init_type":"normal",
            "init_gain":0.02
        }
    },
    "scheduler_para":{
        "ExponentialLR":{
            "gamma":0.9
        },

        "MultiStepLR":{
            "milestones":[50, 100],
            "gamma":0.1,
            "verbose":false
        },
        "step":{
            "step_size":100,
            "gamma":0.1,
            "verbose":true
        },

        "plateau":{
            "mode":"min",
            "factor":0.1,
            "threshold":1e-5,
            "eps":1e-5,
            "patience":6,
            "verbose":true
        },

        "cosine":{
            "T_max":150,
            "eta_min":0
        },

        "linear":{
            "linear_para":{

            },
            "inside_fun":{
                "epoch_count":180,
                "n_epochs_decay":200
            }
        }
        
    }
    
}
    